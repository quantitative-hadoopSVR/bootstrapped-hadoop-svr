distance should eb calculated considering only the variables (not also the label)

at the beginning of the loop the linear chunk is assigned to be equal to the normal chunk. Fix this
.
